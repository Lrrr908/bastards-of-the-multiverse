<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BASTARDS//MULTIVERSE - SYSTEM ACCESS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
    
    :root {
      --primary: #00ff41;
      --secondary: #ff0080;
      --accent: #00d4ff;
      --bg: #000000;
      --grid: rgba(0, 255, 65, 0.1);
      --glow: rgba(0, 255, 65, 0.4);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      background: #000;
      color: var(--primary);
      font-family: 'Orbitron', monospace;
      overflow-x: hidden;
      position: relative;
    }

    #particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: 
        repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0, 255, 65, 0.03) 2px, rgba(0, 255, 65, 0.03) 4px),
        repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(0, 255, 65, 0.03) 2px, rgba(0, 255, 65, 0.03) 4px);
      pointer-events: none;
      z-index: 1;
    }

    body::after {
      content: "";
      position: fixed;
      inset: 0;
      background: linear-gradient(180deg, transparent 0%, rgba(0, 255, 65, 0.05) 50%, transparent 100%);
      animation: scan 4s linear infinite;
      pointer-events: none;
      z-index: 2;
    }

    @keyframes scan {
      0% { transform: translateY(-100%); }
      100% { transform: translateY(100%); }
    }

    .container {
      position: relative;
      z-index: 3;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 2rem;
    }

    /* HEADER */
    header {
      border-bottom: 2px solid var(--primary);
      padding: 1rem 0;
      position: sticky;
      top: 0;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(10px);
      z-index: 100;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 2rem;
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .logo-mark {
      width: 50px;
      height: 50px;
      border: 2px solid var(--primary);
      background: transparent;
      clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
      box-shadow: 0 0 20px var(--glow);
      animation: pulse 2s ease-in-out infinite;
      position: relative;
    }

    .logo-mark::before {
      content: "";
      position: absolute;
      inset: 8px;
      border: 1px solid var(--primary);
      clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
      opacity: 0.5;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.8; transform: scale(1.05); }
    }

    .logo-text h1 {
      font-size: 1.5rem;
      font-weight: 900;
      letter-spacing: 0.2em;
      text-shadow: 0 0 10px var(--glow);
    }

    .logo-text .sub {
      font-size: 0.7rem;
      color: var(--accent);
      letter-spacing: 0.3em;
    }

    .nav-links {
      display: flex;
      gap: 2rem;
      font-size: 0.9rem;
      letter-spacing: 0.15em;
    }

    .nav-links a {
      color: var(--primary);
      text-decoration: none;
      position: relative;
      padding: 0.5rem 0;
      transition: all 0.3s;
      cursor: pointer;
    }

    .nav-links a::before {
      content: ">";
      position: absolute;
      left: -15px;
      opacity: 0;
      transition: all 0.3s;
    }

    .nav-links a:hover {
      color: var(--secondary);
      text-shadow: 0 0 10px var(--secondary);
    }

    .nav-links a:hover::before {
      opacity: 1;
      left: -20px;
    }

    /* SECTION ANIMATIONS */
    section {
      opacity: 0;
      transform: translateY(50px);
      transition: opacity 0.8s ease-out, transform 0.8s ease-out;
    }

    section.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* HERO SECTION */
    .hero {
      padding: 4rem 0;
      position: relative;
      min-height: 90vh;
      display: flex;
      align-items: center;
    }

    .hero-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 4rem;
      align-items: center;
    }

    .system-label {
      font-size: 0.7rem;
      color: var(--accent);
      letter-spacing: 0.3em;
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .system-label::before {
      content: "";
      width: 30px;
      height: 2px;
      background: var(--accent);
    }

    .hero h2 {
      font-size: 3.5rem;
      font-weight: 900;
      line-height: 1.1;
      letter-spacing: 0.05em;
      text-shadow: 0 0 20px var(--glow);
      margin-bottom: 1.5rem;
    }

    .hero h2 .highlight {
      color: var(--secondary);
      text-shadow: 0 0 20px rgba(255, 0, 128, 0.6);
    }

    .hero-desc {
      font-size: 1rem;
      line-height: 1.8;
      color: rgba(0, 255, 65, 0.8);
      margin-bottom: 2rem;
      max-width: 500px;
    }

    .cta-buttons {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .btn {
      padding: 1rem 2rem;
      border: 2px solid var(--primary);
      background: transparent;
      color: var(--primary);
      font-family: 'Orbitron', monospace;
      font-weight: 700;
      letter-spacing: 0.15em;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      transition: all 0.3s;
    }

    .btn::before {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: var(--primary);
      transition: all 0.3s;
      z-index: -1;
    }

    .btn:hover {
      color: #000;
      box-shadow: 0 0 20px var(--glow);
    }

    .btn:hover::before {
      left: 0;
    }

    .btn-secondary {
      border-color: var(--secondary);
      color: var(--secondary);
    }

    .btn-secondary::before {
      background: var(--secondary);
    }

    .system-note {
      font-size: 0.75rem;
      color: rgba(0, 255, 65, 0.6);
      padding: 1rem;
      border-left: 2px solid var(--accent);
      background: rgba(0, 255, 65, 0.05);
    }

    /* VISUAL PANEL */
    .visual-panel {
      border: 2px solid var(--primary);
      padding: 1.5rem;
      position: relative;
      background: rgba(0, 255, 65, 0.03);
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      font-size: 0.8rem;
      letter-spacing: 0.2em;
    }

    .status-dot {
      width: 10px;
      height: 10px;
      background: var(--primary);
      border-radius: 50%;
      box-shadow: 0 0 10px var(--primary);
      animation: blink 1s infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    .preview-box {
      aspect-ratio: 4/3;
      background: #000;
      border: 1px solid rgba(0, 255, 65, 0.3);
      position: relative;
      overflow: hidden;
    }

    .preview-box canvas {
      width: 100%;
      height: 100%;
    }

    .color-chips {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }

    .chip {
      padding: 0.5rem 1rem;
      border: 1px solid var(--primary);
      font-size: 0.7rem;
      letter-spacing: 0.1em;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .chip-color {
      width: 15px;
      height: 15px;
      border: 1px solid var(--primary);
    }

    /* SECTIONS */
    .section {
      padding: 4rem 0;
      border-top: 1px solid rgba(0, 255, 65, 0.2);
      min-height: 100vh;
      display: flex;
      align-items: center;
    }

    .section-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 3rem;
    }

    .section-header h3 {
      font-size: 2rem;
      font-weight: 900;
      margin-bottom: 1rem;
      text-shadow: 0 0 10px var(--glow);
    }

    .section-text {
      font-size: 0.95rem;
      line-height: 1.8;
      color: rgba(0, 255, 65, 0.8);
    }

    .data-card {
      border: 2px solid var(--primary);
      padding: 1.5rem;
      background: rgba(0, 255, 65, 0.03);
      position: relative;
    }

    .data-card::before {
      content: attr(data-id);
      position: absolute;
      top: -12px;
      left: 1rem;
      background: #000;
      padding: 0 0.5rem;
      font-size: 0.7rem;
      color: var(--accent);
      letter-spacing: 0.2em;
    }

    .card-title {
      font-size: 1.2rem;
      font-weight: 700;
      margin-bottom: 1rem;
      color: var(--primary);
    }

    .feature-list {
      list-style: none;
      font-size: 0.85rem;
      line-height: 1.8;
      color: rgba(0, 255, 65, 0.8);
    }

    .feature-list li {
      padding-left: 1.5rem;
      position: relative;
      margin-bottom: 0.5rem;
    }

    .feature-list li::before {
      content: "▸";
      position: absolute;
      left: 0;
      color: var(--secondary);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
      margin-top: 1rem;
    }

    .stat-box {
      border: 1px solid var(--primary);
      padding: 1rem;
      background: rgba(0, 0, 0, 0.5);
    }

    .stat-label {
      font-size: 0.7rem;
      color: var(--accent);
      letter-spacing: 0.15em;
      margin-bottom: 0.25rem;
    }

    .stat-value {
      font-size: 1.1rem;
      font-weight: 700;
    }

    /* COLOR MATCH WIDGET INTEGRATION */
    #colormatch {
      background: rgba(0, 255, 65, 0.02);
      border-top: 2px solid var(--primary);
      border-bottom: 2px solid var(--primary);
      padding: 4rem 0;
      min-height: 100vh;
    }

    .cmw-wrap {
      font-family: 'Orbitron', monospace !important;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
      background: transparent !important;
    }

    .cmw-wrap h5 {
      font-size: 2.5rem;
      margin: 0 0 32px;
      font-weight: 900;
      color: var(--primary);
      text-align: center;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      text-shadow: 0 0 20px var(--glow);
    }

    .cmw-section {
      margin-bottom: 24px;
      padding: 24px;
      border: 2px solid var(--primary);
      border-radius: 0;
      background: rgba(0, 255, 65, 0.03);
      box-shadow: 0 0 20px var(--glow);
      transition: all 0.3s;
    }

    .cmw-section:hover {
      border-color: var(--accent);
      box-shadow: 0 0 30px var(--glow);
    }

    .cmw-section h6 {
      font-size: 1.1rem;
      margin: 0 0 20px;
      font-weight: 600;
      color: var(--primary);
      text-align: center;
      letter-spacing: 0.15em;
    }

    .cmw-input-group {
      display: flex;
      flex-direction: column;
      gap: 16px;
      align-items: center;
    }

    .cmw-values-section {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .cmw-value-type-selector {
      display: flex;
      justify-content: center;
      margin-bottom: 16px;
    }

    .cmw-value-type-select {
      padding: 12px 16px;
      font-size: 16px;
      border: 2px solid var(--primary);
      border-radius: 0;
      background: rgba(0, 0, 0, 0.8);
      color: var(--primary);
      cursor: pointer;
      min-width: 180px;
      text-align: center;
      font-family: 'Orbitron', monospace;
    }

    .cmw-value-type-select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 10px var(--glow);
    }

    .cmw-color-preview-container {
      display: flex;
      align-items: flex-start;
      justify-content: center;
      gap: 20px;
      margin: 16px auto;
      flex-wrap: wrap;
      min-height: 80px;
      position: relative;
    }

    .cmw-color-preview {
      width: 60px;
      height: 60px;
      border: 3px solid var(--primary);
      border-radius: 0;
      background: rgba(0, 0, 0, 0.8);
      transition: all 0.3s ease;
      position: relative;
      display: block;
      flex-shrink: 0;
      box-shadow: 0 0 15px var(--glow);
      filter: none;
      opacity: 1;
    }

    .cmw-selected-color-info {
      display: none;
      flex-direction: column;
      gap: 12px;
      padding: 16px;
      background: rgba(0, 255, 65, 0.05);
      border: 2px solid var(--primary);
      border-radius: 0;
      min-width: 180px;
      max-width: 250px;
      flex-shrink: 0;
      position: relative;
    }

    .cmw-selected-color-info.show {
      display: flex;
    }

    .cmw-selected-color-library {
      font-size: 15px;
      color: var(--primary);
      text-align: center;
      font-weight: 600;
    }

    .cmw-selected-color-lab {
      font-size: 13px;
      color: var(--accent);
      text-align: center;
      font-family: 'Courier New', monospace;
      background: rgba(0, 0, 0, 0.8);
      padding: 8px;
      border-radius: 0;
      border: 1px solid var(--primary);
    }

    .cmw-value-inputs {
      display: none;
      justify-content: center;
      gap: 16px;
      flex-wrap: wrap;
    }

    .cmw-value-inputs.active {
      display: flex;
    }

    .cmw-wrap input {
      padding: 12px 16px;
      font-size: 16px;
      border: 2px solid var(--primary);
      border-radius: 0;
      transition: all 0.2s;
      background: rgba(0, 0, 0, 0.8);
      color: var(--primary);
      width: 100%;
      max-width: 350px;
      font-family: 'Orbitron', monospace;
    }

    .cmw-wrap input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 10px var(--glow);
    }

    .cmw-wrap button {
      padding: 12px 32px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      border: 2px solid var(--primary);
      background: transparent;
      color: var(--primary);
      border-radius: 0;
      transition: all 0.3s;
      white-space: nowrap;
      font-family: 'Orbitron', monospace;
      position: relative;
      overflow: hidden;
    }

    .cmw-wrap button::before {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: var(--primary);
      transition: all 0.3s;
      z-index: -1;
    }

    .cmw-wrap button:hover {
      color: #000;
      box-shadow: 0 0 20px var(--glow);
    }

    .cmw-wrap button:hover::before {
      left: 0;
    }

    .cmw-library-toggles {
      margin-bottom: 24px;
      padding: 20px;
      background: rgba(0, 255, 65, 0.03);
      border: 2px solid var(--primary);
      border-radius: 0;
      box-shadow: 0 0 15px var(--glow);
    }

    .cmw-toggle-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
    }

    .cmw-toggle-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 0;
      transition: all 0.2s;
      border: 2px solid transparent;
    }

    .cmw-toggle-item:hover {
      background: rgba(0, 255, 65, 0.1);
      border-color: var(--primary);
    }

    .cmw-toggle-item input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
      accent-color: var(--primary);
    }

    .cmw-wrap table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 24px;
      background: rgba(0, 0, 0, 0.8);
      border-radius: 0;
      overflow: hidden;
      border: 2px solid var(--primary);
    }

    .cmw-wrap th,
    .cmw-wrap td {
      padding: 12px;
      border-bottom: 1px solid var(--primary);
      font-size: 14px;
      text-align: left;
      color: var(--primary);
    }

    .cmw-wrap th {
      background: rgba(0, 255, 65, 0.1);
      font-weight: 600;
      color: var(--primary);
    }

    /* COORDINATES */
    .coordinates {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      font-size: 0.7rem;
      color: rgba(0, 255, 65, 0.5);
      letter-spacing: 0.1em;
      z-index: 50;
      font-family: monospace;
    }

    /* FOOTER */
    footer {
      border-top: 2px solid var(--primary);
      padding: 2rem 0;
      margin-top: 4rem;
    }

    .footer-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 2rem;
      font-size: 0.8rem;
    }

    .footer-links {
      display: flex;
      gap: 2rem;
    }

    .footer-links a {
      color: var(--primary);
      text-decoration: none;
      transition: all 0.3s;
      cursor: pointer;
    }

    .footer-links a:hover {
      color: var(--secondary);
      text-shadow: 0 0 10px var(--secondary);
    }

    @media (max-width: 768px) {
      .hero-grid,
      .section-grid {
        grid-template-columns: 1fr;
        gap: 2rem;
      }

      .nav-links {
        display: none;
      }

      .hero h2 {
        font-size: 2rem;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Additional CMW styles */
    .cmw-lab-group,
    .cmw-cmyk-group,
    .cmw-rgb-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .cmw-lab-input,
    .cmw-cmyk-input,
    .cmw-rgb-input {
      width: 80px !important;
      max-width: 80px !important;
      text-align: center;
    }

    .cmw-lab-label,
    .cmw-cmyk-label,
    .cmw-rgb-label {
      font-weight: 600;
      color: var(--primary);
      font-size: 14px;
    }

    .cmw-loading {
      display: none;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin: 20px 0;
      color: var(--accent);
    }

    .cmw-loading.show {
      display: flex;
    }

    .cmw-spinner {
      width: 20px;
      height: 20px;
      border: 2px solid var(--grid);
      border-top: 2px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .cmw-status {
      margin: 16px 0;
      padding: 12px;
      border-radius: 0;
      display: none;
      text-align: center;
      font-weight: 500;
      border: 2px solid;
    }

    .cmw-status.success {
      background: rgba(0, 255, 65, 0.1);
      color: var(--primary);
      border-color: var(--primary);
    }

    .cmw-status.error {
      background: rgba(255, 0, 128, 0.1);
      color: var(--secondary);
      border-color: var(--secondary);
    }

    .cmw-status.warning {
      background: rgba(0, 212, 255, 0.1);
      color: var(--accent);
      border-color: var(--accent);
    }

    .cmw-status.show {
      display: block;
    }

    .cmw-swatch {
      width: 60px;
      height: 30px;
      border: 1px solid var(--primary);
      border-radius: 0;
      filter: none;
      opacity: 1;
      box-shadow: none;
    }

    .cmw-suggestions {
      margin-top: 12px;
      padding: 0;
      background: rgba(0, 0, 0, 0.9);
      border: 1px solid var(--primary);
      border-radius: 0;
      display: none;
      box-shadow: 0 0 20px var(--glow);
      max-width: 350px;
      width: 100%;
      max-height: 300px;
      overflow-y: auto;
      position: relative;
      z-index: 100;
    }

    .cmw-suggestions.show {
      display: block;
    }

    .cmw-suggestions-header {
      position: sticky;
      top: 0;
      background: rgba(0, 255, 65, 0.1);
      padding: 12px;
      font-weight: 600;
      color: var(--primary);
      border-bottom: 1px solid var(--primary);
      z-index: 10;
    }

    .cmw-suggestion {
      cursor: pointer;
      padding: 12px 16px;
      margin: 2px 0;
      border-radius: 0;
      transition: background 0.1s ease;
      color: var(--primary);
      background: rgba(0, 0, 0, 0.8);
      border: 1px solid var(--primary);
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
      -webkit-user-select: none;
      position: relative;
    }

    .cmw-suggestion:hover {
      background: rgba(0, 255, 65, 0.2);
      color: var(--primary);
      border-color: var(--accent);
    }

    .cmw-brand-hint {
      color: var(--accent);
      font-size: 0.9em;
    }

    /* TERMINAL WINDOW */
    .terminal-window {
      border: 2px solid var(--primary);
      background: rgba(0, 0, 0, 0.9);
      padding: 0;
      overflow: hidden;
      box-shadow: 0 0 30px var(--glow);
    }

    .terminal-header {
      background: rgba(0, 255, 65, 0.1);
      padding: 0.5rem 1rem;
      border-bottom: 1px solid var(--primary);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .terminal-dots {
      display: flex;
      gap: 0.3rem;
    }

    .terminal-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--primary);
    }

    .terminal-dot:nth-child(2) {
      background: var(--secondary);
    }

    .terminal-dot:nth-child(3) {
      background: var(--accent);
    }

    .terminal-title {
      font-size: 0.75rem;
      letter-spacing: 0.1em;
      margin-left: auto;
    }

    .terminal-body {
      padding: 1.5rem;
      font-family: 'Courier New', monospace;
      font-size: 0.85rem;
      line-height: 1.6;
      color: rgba(0, 255, 65, 0.9);
    }

    .terminal-prompt {
      color: var(--accent);
    }

    .terminal-command {
      color: var(--primary);
      margin-left: 0.5rem;
    }

    /* GLITCH EFFECT */
    .glitch {
      position: relative;
      display: inline-block;
    }

    .glitch::before,
    .glitch::after {
      content: attr(data-text);
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0.8;
    }

    .glitch::before {
      animation: glitch-1 2s infinite;
      color: var(--secondary);
      z-index: -1;
    }

    .glitch::after {
      animation: glitch-2 3s infinite;
      color: var(--accent);
      z-index: -2;
    }

    @keyframes glitch-1 {
      0%, 100% { transform: translate(0); }
      20% { transform: translate(-2px, 2px); }
      40% { transform: translate(-2px, -2px); }
      60% { transform: translate(2px, 2px); }
      80% { transform: translate(2px, -2px); }
    }

    @keyframes glitch-2 {
      0%, 100% { transform: translate(0); }
      20% { transform: translate(2px, -2px); }
      40% { transform: translate(2px, 2px); }
      60% { transform: translate(-2px, -2px); }
      80% { transform: translate(-2px, 2px); }
    }

    /* METRIC DASHBOARD */
    .metric-dashboard {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1.5rem;
      margin: 3rem 0;
    }

    .metric-tile {
      border: 2px solid var(--primary);
      padding: 1.5rem;
      background: rgba(0, 255, 65, 0.03);
      position: relative;
      overflow: hidden;
    }

    .metric-tile::before {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: var(--primary);
      box-shadow: 0 0 10px var(--primary);
    }

    .metric-value {
      font-size: 2.5rem;
      font-weight: 900;
      line-height: 1;
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .metric-label {
      font-size: 0.7rem;
      letter-spacing: 0.2em;
      color: var(--accent);
      text-transform: uppercase;
    }

    .metric-change {
      font-size: 0.65rem;
      color: var(--primary);
      margin-top: 0.5rem;
    }

    /* STATUS PANEL */
    .status-panel {
      border: 2px solid var(--primary);
      background: rgba(0, 255, 65, 0.02);
      padding: 1.5rem;
      margin: 2rem 0;
    }

    .status-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 0;
      border-bottom: 1px solid rgba(0, 255, 65, 0.1);
    }

    .status-row:last-child {
      border-bottom: none;
    }

    .status-name {
      font-size: 0.85rem;
      letter-spacing: 0.1em;
    }

    .status-value {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.85rem;
    }

    .status-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--primary);
      box-shadow: 0 0 10px var(--primary);
      animation: blink 1.5s infinite;
    }

    .status-indicator.warning {
      background: #ffaa00;
      box-shadow: 0 0 10px #ffaa00;
    }

    /* QUOTE/CALLOUT BOX */
    .quote-box {
      border-left: 4px solid var(--accent);
      background: rgba(0, 212, 255, 0.05);
      padding: 2rem;
      margin: 3rem 0;
      font-size: 1.1rem;
      line-height: 1.8;
      font-style: italic;
      color: rgba(0, 255, 65, 0.9);
    }

    .quote-author {
      margin-top: 1rem;
      font-style: normal;
      font-size: 0.8rem;
      color: var(--accent);
      letter-spacing: 0.15em;
    }
  </style>
</head>
<body>

  <!-- Particle background layer -->
  <canvas id="particles"></canvas>

  <header>
    <div class="header-content">
      <div class="logo-section">
        <div class="logo-mark"></div>
        <div class="logo-text">
          <h1>BASTARDS//MV</h1>
          <div class="sub">SYSTEM ONLINE</div>
        </div>
      </div>
      <nav class="nav-links">
        <a onclick="scrollToSection('hero')">HOME</a>
        <a onclick="scrollToSection('colormatch')">COLOR.MATCH</a>
        <a onclick="scrollToSection('contact')">CONTACT</a>
      </nav>
    </div>
  </header>

  <div class="container">
    
    <!-- HERO -->
    <section class="hero visible" id="hero">
      <div class="hero-grid">
        <div>
          <div class="system-label">CUSTOM 3D FABRICATION SYSTEM</div>
          <h2><span class="glitch" data-text="DESIGN YOUR">DESIGN YOUR</span> <span class="highlight">BASTARD</span>.<br>MATCH YOUR COLOR.<br>BUILD FOR REAL.</h2>
          <p class="hero-desc">
            One person toy lab. Custom sculpted multiverse misfits powered by BotMCMS color engine. 
            Real resin, filament, and Bastone spot matching. Every build handled direct. No cart. No checkout. 
            Just pure design-to-DM workflow.
          </p>
          <div class="cta-buttons">
            <button class="btn" onclick="scrollToSection('colormatch')">ACCESS COLOR.MATCH</button>
            <button class="btn btn-secondary" onclick="scrollToSection('contact')">START PROJECT</button>
          </div>
          <div class="system-note">
            >> PROTOCOL: Generate project link → DM on Instagram → Human builds it. <br>
            >> STATUS: <span style="color: var(--accent);">BOTMCMS ENGINE ONLINE</span> | <span style="color: var(--secondary);">3 ACTIVE PROJECTS</span>
          </div>
        </div>

        <div class="visual-panel">
          <div class="panel-header">
            <span>LIVE PREVIEW [INTERACTIVE]</span>
            <div style="display: flex; align-items: center; gap: 0.5rem;">
              <span class="status-dot"></span>
              <span>BOTMCMS ACTIVE</span>
            </div>
          </div>
          <div class="preview-box">
            <canvas id="colorWheel"></canvas>
          </div>
          <div class="color-chips">
            <div class="chip">
              <div class="chip-color" style="background:#FFC845;"></div>
              BASTONE 123C
            </div>
            <div class="chip">
              <div class="chip-color" style="background:#FFCC4A;"></div>
              ESUN PLA+ WARM
            </div>
            <div class="chip">
              <div class="chip-color" style="background:#F8C94D;"></div>
              SIRAYA FAST YELLOW
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- METRICS DASHBOARD -->
    <section class="section">
      <div class="metric-dashboard">
        <div class="metric-tile">
          <div class="metric-value" id="metric-colors">2,847</div>
          <div class="metric-label">Color Library</div>
          <div class="metric-change">↑ 4 brands indexed</div>
        </div>
        <div class="metric-tile">
          <div class="metric-value">ΔE &lt;3</div>
          <div class="metric-label">Match Accuracy</div>
          <div class="metric-change">Professional Grade</div>
        </div>
        <div class="metric-tile">
          <div class="metric-value">1:1</div>
          <div class="metric-label">Human to Human</div>
          <div class="metric-change">Direct DM Protocol</div>
        </div>
        <div class="metric-tile">
          <div class="metric-value">24/7</div>
          <div class="metric-label">System Uptime</div>
          <div class="metric-change">API Active</div>
        </div>
      </div>
    </section>

  </div>

  <!-- COLOR MATCH WIDGET SECTION -->
  <section id="colormatch">
    <div class="cmw-wrap">
      <h5>+COLOR MATCH</h5>
      
      <input type="hidden" id="cmw-api-url" value="https://botm-ucxq.onrender.com">
      
      <div class="cmw-library-toggles">
        <h6>Color Libraries</h6>
        <div class="cmw-toggle-grid">
          <div class="cmw-toggle-item">
            <input type="checkbox" id="toggle-pantone" value="pantone" checked>
            <label for="toggle-pantone">Pantone <span class="cmw-library-count" id="count-pantone">(loading...)</span></label>
          </div>
          <div class="cmw-toggle-item">
            <input type="checkbox" id="toggle-behr" value="behr" checked>
            <label for="toggle-behr">Behr <span class="cmw-library-count" id="count-behr">(loading...)</span></label>
          </div>
          <div class="cmw-toggle-item">
            <input type="checkbox" id="toggle-sherwin" value="sherwin" checked>
            <label for="toggle-sherwin">Sherwin Williams <span class="cmw-library-count" id="count-sherwin">(loading...)</span></label>
          </div>
          <div class="cmw-toggle-item">
            <input type="checkbox" id="toggle-bm" value="bm" checked>
            <label for="toggle-bm">Benjamin Moore <span class="cmw-library-count" id="count-bm">(loading...)</span></label>
          </div>
        </div>
        
        <div style="height: 1px; background: linear-gradient(to right, transparent, rgba(0, 255, 65, 0.2) 20%, rgba(0, 255, 65, 0.2) 80%, transparent); margin: 20px 0;"></div>
        
        <div style="display: flex; justify-content: center; align-items: center; gap: 24px; margin-top: 16px; flex-wrap: wrap;">
          <div style="display: flex; align-items: center; gap: 8px;">
            <label for="cmw-results-count" style="font-weight: 600; color: var(--primary); white-space: nowrap;">Results per library:</label>
            <select id="cmw-results-count" class="cmw-value-type-select" style="min-width: 80px;">
              <option value="1" selected>1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="5">5</option>
              <option value="10">10</option>
            </select>
          </div>
        </div>
      </div>
      
      <div class="cmw-section">
        <h6>Color Search</h6>
        <div class="cmw-input-group">
          <div class="cmw-values-section">
            <div class="cmw-value-type-selector">
              <select id="cmw-search-type-select" class="cmw-value-type-select">
                <option value="name" selected>Color Number or Hex</option>
                <option value="lab">Lab Values</option>
                <option value="cmyk">CMYK Values</option>
                <option value="rgb">RGB Values</option>
              </select>
            </div>

            <div class="cmw-color-preview-container">
              <div id="cmw-color-preview" class="cmw-color-preview"></div>
              <div id="cmw-selected-color-info" class="cmw-selected-color-info">
                <div id="cmw-selected-color-library" class="cmw-selected-color-library"></div>
                <div id="cmw-selected-color-lab" class="cmw-selected-color-lab"></div>
              </div>
            </div>

            <div id="cmw-name-inputs" class="cmw-value-inputs active">
              <input id="cmw-name-input" class="cmw-name-input" placeholder="Enter color number or hex (e.g., PANTONE 185 C, Behr 3405, #FF0000)">
            </div>
            <div id="cmw-name-suggestions" class="cmw-suggestions">
              <div class="cmw-suggestions-header">Suggestions:</div>
              <div class="cmw-suggestions-content"></div>
            </div>

            <div id="cmw-lab-inputs" class="cmw-value-inputs">
              <div class="cmw-lab-group">
                <span class="cmw-lab-label">L*</span>
                <input id="cmw-lab-l" class="cmw-lab-input" type="number" placeholder="0-100" min="0" max="100" step="0.1">
              </div>
              <div class="cmw-lab-group">
                <span class="cmw-lab-label">a*</span>
                <input id="cmw-lab-a" class="cmw-lab-input" type="number" placeholder="-128-127" min="-128" max="127" step="0.1">
              </div>
              <div class="cmw-lab-group">
                <span class="cmw-lab-label">b*</span>
                <input id="cmw-lab-b" class="cmw-lab-input" type="number" placeholder="-128-127" min="-128" max="127" step="0.1">
              </div>
            </div>

            <div id="cmw-cmyk-inputs" class="cmw-value-inputs">
              <div class="cmw-cmyk-group">
                <span class="cmw-cmyk-label">C</span>
                <input id="cmw-cmyk-c" class="cmw-cmyk-input" type="number" placeholder="0-100" min="0" max="100" step="0.1">
              </div>
              <div class="cmw-cmyk-group">
                <span class="cmw-cmyk-label">M</span>
                <input id="cmw-cmyk-m" class="cmw-cmyk-input" type="number" placeholder="0-100" min="0" max="100" step="0.1">
              </div>
              <div class="cmw-cmyk-group">
                <span class="cmw-cmyk-label">Y</span>
                <input id="cmw-cmyk-y" class="cmw-cmyk-input" type="number" placeholder="0-100" min="0" max="100" step="0.1">
              </div>
              <div class="cmw-cmyk-group">
                <span class="cmw-cmyk-label">K</span>
                <input id="cmw-cmyk-k" class="cmw-cmyk-input" type="number" placeholder="0-100" min="0" max="100" step="0.1">
              </div>
            </div>

            <div id="cmw-rgb-inputs" class="cmw-value-inputs">
              <div class="cmw-rgb-group">
                <span class="cmw-rgb-label">R</span>
                <input id="cmw-rgb-r" class="cmw-rgb-input" type="number" placeholder="0-255" min="0" max="255">
              </div>
              <div class="cmw-rgb-group">
                <span class="cmw-rgb-label">G</span>
                <input id="cmw-rgb-g" class="cmw-rgb-input" type="number" placeholder="0-255" min="0" max="255">
              </div>
              <div class="cmw-rgb-group">
                <span class="cmw-rgb-label">B</span>
                <input id="cmw-rgb-b" class="cmw-rgb-input" type="number" placeholder="0-255" min="0" max="255">
              </div>
            </div>
          </div>
          <button id="cmw-search-btn">Search</button>
        </div>
      </div>

      <div id="cmw-loading" class="cmw-loading">
        <div class="cmw-spinner"></div>
        <span>Searching...</span>
      </div>

      <div id="cmw-status" class="cmw-status"></div>

      <table id="cmw-out" hidden>
        <thead>
          <tr>
            <th>Swatch</th>
            <th>Name</th>
            <th>Brand</th>
            <th>ΔE</th>
            <th>Lab</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <div class="container">
    <!-- SECTION: CONTACT -->
    <section class="section" id="contact">
      <div class="section-grid">
        <div>
          <div class="system-label">DIRECT CHANNEL</div>
          <div class="section-header">
            <h3>DM TO START.<br>BUILD TO FINISH.</h3>
          </div>
          <p class="section-text">
            Custom figure build, color match consultation for client projects, or just nerding out about 
            color science and toy design. All coordination happens through Instagram DM with project links 
            keeping everything organized.
          </p>
          <p class="section-text" style="margin-top: 1.5rem;">
            Response time is typically under 24 hours. Active projects get priority updates. 
            No automated responses—just direct human communication from start to delivery.
          </p>

          <div class="status-panel" style="margin-top: 2rem;">
            <div class="status-row">
              <div class="status-name">INSTAGRAM DM</div>
              <div class="status-value">
                <span class="status-indicator"></span>
                <span>@YOUR_INSTAGRAM_HANDLE</span>
              </div>
            </div>
            <div class="status-row">
              <div class="status-name">RESPONSE TIME</div>
              <div class="status-value">
                <span class="status-indicator"></span>
                <span>&lt;24 HOURS</span>
              </div>
            </div>
            <div class="status-row">
              <div class="status-name">BUILD QUEUE</div>
              <div class="status-value">
                <span class="status-indicator warning"></span>
                <span>CURRENTLY 3 ACTIVE</span>
              </div>
            </div>
            <div class="status-row">
              <div class="status-name">LEAD TIME</div>
              <div class="status-value">
                <span class="status-indicator"></span>
                <span>2-4 WEEKS</span>
              </div>
            </div>
          </div>
        </div>

        <div class="terminal-window">
          <div class="terminal-header">
            <div class="terminal-dots">
              <div class="terminal-dot"></div>
              <div class="terminal-dot"></div>
              <div class="terminal-dot"></div>
            </div>
            <div class="terminal-title">CONTACT.INFO</div>
          </div>
          <div class="terminal-body">
            <div><span class="terminal-prompt">user@bastards:~$</span><span class="terminal-command"> cat contact.txt</span></div>
            <div style="margin-top: 1rem;">
              <div style="color: var(--accent);">PRIMARY CHANNEL:</div>
              <div style="margin-left: 1rem;">Instagram DM: @YOUR_INSTAGRAM_HANDLE</div>
              
              <div style="margin-top: 1rem; color: var(--accent);">WHAT TO INCLUDE IN YOUR DM:</div>
              <div style="margin-left: 1rem; font-size: 0.85rem;">
                <div>• Project link (if generated)</div>
                <div>• Rough idea description</div>
                <div>• Reference images (optional)</div>
                <div>• Color requirements (optional)</div>
                <div>• Timeline needs (optional)</div>
              </div>

              <div style="margin-top: 1rem; color: var(--accent);">WHAT YOU'LL GET BACK:</div>
              <div style="margin-left: 1rem; font-size: 0.85rem;">
                <div>• Feasibility assessment</div>
                <div>• Estimated cost breakdown</div>
                <div>• Lead time estimate</div>
                <div>• Color/material questions</div>
                <div>• PayPal payment info</div>
              </div>

              <div style="margin-top: 1rem; color: var(--accent);">PAYMENT:</div>
              <div style="margin-left: 1rem;">PayPal (details provided in DM)</div>

              <div style="margin-top: 1rem; color: var(--accent);">LOCATION:</div>
              <div style="margin-left: 1rem;">Lexington, KY, USA</div>
            </div>
            <div style="margin-top: 1rem;"><span class="terminal-prompt">user@bastards:~$</span><span class="terminal-command"> █</span></div>
          </div>
        </div>
      </div>

      <div class="data-card" data-id="[FAQ.QUICK]" style="margin-top: 3rem;">
        <div class="card-title">QUICK FAQ</div>
        <ul class="feature-list">
          <li><strong>Can I get a quote without DM?</strong> No—every build is different and needs conversation.</li>
          <li><strong>Do you ship internationally?</strong> Yes. Shipping costs calculated per project.</li>
          <li><strong>Can I request custom sculpts?</strong> Depends on complexity. DM to discuss.</li>
          <li><strong>What if I need a specific Pantone color?</strong> Use Color.Match tool, then include in DM.</li>
          <li><strong>Can I see work-in-progress photos?</strong> Yes—milestone updates included with every build.</li>
          <li><strong>What's your refund policy?</strong> Discussed case-by-case before payment.</li>
        </ul>
      </div>
    </section>

  </div>

  <footer>
    <div class="footer-content">
      <div>
        BASTARDS OF THE MULTIVERSE /// ONE PERSON TOY LAB /// COLOR MATH BY BOTMCMS /// EST.2024
      </div>
      <div class="footer-links">
        <a onclick="scrollToSection('colormatch')">COLOR.MATCH</a>
        <a onclick="scrollToSection('contact')">CONTACT</a>
      </div>
    </div>
  </footer>

  <div class="coordinates">
    LAT: 38.0486° N | LONG: -84.5037° W | SYSTEM.TIME: <span id="time"></span>
  </div>

  <script>
    // ============================================
    // PARTICLE SYSTEM
    // ============================================
    const particleCanvas = document.getElementById('particles');
    const particleCtx = particleCanvas.getContext('2d');

    function resizeParticleCanvas() {
      particleCanvas.width = window.innerWidth;
      particleCanvas.height = document.body.scrollHeight;
    }
    resizeParticleCanvas();
    window.addEventListener('resize', resizeParticleCanvas);

    const particles = [];
    const particleCount = 80;

    class Particle {
      constructor() {
        this.reset();
      }

      reset() {
        this.x = Math.random() * particleCanvas.width;
        this.y = Math.random() * particleCanvas.height;
        this.size = Math.random() * 2 + 0.5;
        this.speedX = (Math.random() - 0.5) * 0.5;
        this.speedY = (Math.random() - 0.5) * 0.5;
        this.opacity = Math.random() * 0.5 + 0.2;
      }

      update() {
        this.x += this.speedX;
        this.y += this.speedY;

        if (this.x < 0 || this.x > particleCanvas.width) this.speedX *= -1;
        if (this.y < 0 || this.y > particleCanvas.height) this.speedY *= -1;
      }

      draw() {
        particleCtx.fillStyle = `rgba(0, 255, 65, ${this.opacity})`;
        particleCtx.beginPath();
        particleCtx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        particleCtx.fill();
      }
    }

    for (let i = 0; i < particleCount; i++) {
      particles.push(new Particle());
    }

    function animateParticles() {
      particleCtx.clearRect(0, 0, particleCanvas.width, particleCanvas.height);
      
      particles.forEach((particle, i) => {
        particle.update();
        particle.draw();

        // Draw connections
        for (let j = i + 1; j < particles.length; j++) {
          const dx = particles[j].x - particle.x;
          const dy = particles[j].y - particle.y;
          const distance = Math.sqrt(dx * dx + dy * dy);

          if (distance < 150) {
            particleCtx.strokeStyle = `rgba(0, 255, 65, ${0.15 * (1 - distance / 150)})`;
            particleCtx.lineWidth = 0.5;
            particleCtx.beginPath();
            particleCtx.moveTo(particle.x, particle.y);
            particleCtx.lineTo(particles[j].x, particles[j].y);
            particleCtx.stroke();
          }
        }
      });

      requestAnimationFrame(animateParticles);
    }

    animateParticles();

    // ============================================
    // SMOOTH SCROLL & NAVIGATION
    // ============================================
    function scrollToSection(sectionId) {
      const section = document.getElementById(sectionId);
      if (section) {
        section.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    // ============================================
    // INTERSECTION OBSERVER FOR ANIMATIONS
    // ============================================
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -100px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, observerOptions);

    document.querySelectorAll('section').forEach(section => {
      observer.observe(section);
    });

    // ============================================
    // ANIMATED COUNTER FOR METRICS
    // ============================================
    function animateCounter(element, target, duration = 2000) {
      const start = 0;
      const increment = target / (duration / 16);
      let current = start;

      const timer = setInterval(() => {
        current += increment;
        if (current >= target) {
          element.textContent = target.toLocaleString();
          clearInterval(timer);
        } else {
          element.textContent = Math.floor(current).toLocaleString();
        }
      }, 16);
    }

    // Trigger counter animation when metric tiles are visible
    const metricObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting && !entry.target.dataset.animated) {
          entry.target.dataset.animated = 'true';
          const valueEl = entry.target.querySelector('.metric-value');
          const text = valueEl.textContent;
          const numMatch = text.match(/[\d,]+/);
          if (numMatch) {
            const num = parseInt(numMatch[0].replace(/,/g, ''));
            animateCounter(valueEl, num);
          }
        }
      });
    }, { threshold: 0.5 });

    document.querySelectorAll('.metric-tile').forEach(tile => {
      metricObserver.observe(tile);
    });

    // ============================================
    // TIME DISPLAY
    // ============================================
    function updateTime() {
      const now = new Date();
      const hours = String(now.getHours()).padStart(2, '0');
      const minutes = String(now.getMinutes()).padStart(2, '0');
      const seconds = String(now.getSeconds()).padStart(2, '0');
      const timeEl = document.getElementById('time');
      if (timeEl) {
        timeEl.textContent = `${hours}:${minutes}:${seconds}`;
      }
    }
    setInterval(updateTime, 1000);
    updateTime();

    // ============================================
    // 3D COLOR WHEEL
    // ============================================
    const canvas = document.getElementById('colorWheel');
    if (canvas) {
      const ctx = canvas.getContext('2d');
      
      function resize() {
        const box = canvas.parentElement;
        canvas.width = box.offsetWidth;
        canvas.height = box.offsetHeight;
      }
      resize();
      window.addEventListener('resize', resize);

      let rotation = 0;
      let rotationSpeed = 0.005;
      let isDragging = false;
      let lastMouseX = 0;
      let mouseVelocity = 0;
      let tilt = 0;
      let targetTilt = 0;

      canvas.addEventListener('mousedown', (e) => {
        isDragging = true;
        lastMouseX = e.clientX;
        mouseVelocity = 0;
      });

      canvas.addEventListener('mousemove', (e) => {
        if (isDragging) {
          const deltaX = e.clientX - lastMouseX;
          mouseVelocity = deltaX * 0.01;
          rotation += mouseVelocity;
          lastMouseX = e.clientX;
          
          const rect = canvas.getBoundingClientRect();
          const mouseY = e.clientY - rect.top;
          targetTilt = ((mouseY / rect.height) - 0.5) * 0.8;
        }
      });

      canvas.addEventListener('mouseup', () => {
        isDragging = false;
      });

      canvas.addEventListener('mouseleave', () => {
        isDragging = false;
        targetTilt = 0;
      });

      canvas.style.cursor = 'grab';
      canvas.addEventListener('mousedown', () => canvas.style.cursor = 'grabbing');
      canvas.addEventListener('mouseup', () => canvas.style.cursor = 'grab');

      function drawColorWheel() {
        const w = canvas.width;
        const h = canvas.height;
        const cx = w / 2;
        const cy = h / 2;
        const radius = Math.min(w, h) * 0.42;

        ctx.fillStyle = '#000';
        ctx.fillRect(0, 0, w, h);

        tilt += (targetTilt - tilt) * 0.1;

        if (!isDragging) {
          rotation += rotationSpeed;
          mouseVelocity *= 0.95;
        }

        const segments = 24;
        const rings = 8;

        for (let r = 0; r < rings; r++) {
          const ringRadius = (radius / rings) * (r + 1);
          
          for (let i = 0; i < segments; i++) {
            const angle1 = (i / segments) * Math.PI * 2 + rotation;
            const angle2 = ((i + 1) / segments) * Math.PI * 2 + rotation;
            
            const z1 = Math.sin(angle1) * 0.5 + 0.5;
            const z2 = Math.sin(angle2) * 0.5 + 0.5;
            
            const x1 = cx + Math.cos(angle1) * ringRadius * z1;
            const y1 = cy + (Math.sin(angle1) * ringRadius * 0.6 + tilt * ringRadius) * z1;
            const x2 = cx + Math.cos(angle2) * ringRadius * z2;
            const y2 = cy + (Math.sin(angle2) * ringRadius * 0.6 + tilt * ringRadius) * z2;

            const hue = (i / segments) * 360;
            const lightness = 40 + (r / rings) * 40;
            
            ctx.strokeStyle = `hsl(${hue}, 100%, ${lightness}%)`;
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();

            ctx.fillStyle = `hsl(${hue}, 100%, ${lightness}%)`;
            ctx.beginPath();
            ctx.arc(x1, y1, 2, 0, Math.PI * 2);
            ctx.fill();
          }
        }

        ctx.fillStyle = '#00ff41';
        ctx.shadowBlur = 20;
        ctx.shadowColor = '#00ff41';
        ctx.beginPath();
        ctx.arc(cx, cy, 4, 0, Math.PI * 2);
        ctx.fill();
        ctx.shadowBlur = 0;

        requestAnimationFrame(drawColorWheel);
      }

      drawColorWheel();
    }

    // COLOR MATCH WIDGET
    const API_BASE_URL = document.getElementById('cmw-api-url')?.value || 'https://botm-ucxq.onrender.com';

    const urls = {
      pantone: `${API_BASE_URL}/libraries/pantone`,
      behr: `${API_BASE_URL}/libraries/behr`,
      sherwin: `${API_BASE_URL}/libraries/sherwin`,
      bm: `${API_BASE_URL}/libraries/benjaminmoore`
    };

    const libs = {};
    
    const libNames = {
      pantone: 'Pantone',
      behr: 'Behr',
      sherwin: 'Sherwin Williams',
      bm: 'Benjamin Moore'
    };

    async function load(id, url) {
      try {
        console.log(`Loading ${id} from ${url}...`);
        const res = await fetch(url);
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const colors = await res.json();
        
        libs[id] = colors.map(color => ({
          ...color,
          library: id,
          libraryName: libNames[id]
        }));
        
        const countEl = document.getElementById(`count-${id}`);
        if (countEl) {
          countEl.textContent = `(${colors.length})`;
        }
        
        console.log(`✔ ${id} loaded (${libs[id].length} colors)`);
      } catch (e) {
        console.error(`✖ ${id} failed (${url})`, e);
        libs[id] = [];
        const countEl = document.getElementById(`count-${id}`);
        if (countEl) {
          countEl.textContent = `(error)`;
        }
      }
    }

    let libsLoaded = false;

    async function callColorMatchAPI(inputType, value) {
      try {
        showLoading(true);
        
        const response = await fetch(`${API_BASE_URL}/colormatch`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ input_type: inputType, value: value })
        });
        
        if (!response.ok) {
          const error = await response.json();
          throw new Error(error.detail || 'API request failed');
        }
        
        const data = await response.json();
        showLoading(false);
        return data;
        
      } catch (error) {
        showLoading(false);
        showStatus(`Error: ${error.message}`, 'error');
        throw error;
      }
    }

    function showLoading(show = true) {
      const loading = document.getElementById('cmw-loading');
      if (loading) loading.classList.toggle('show', show);
    }

    function showStatus(message, type = 'success') {
      const status = document.getElementById('cmw-status');
      if (status) {
        status.textContent = message;
        status.className = `cmw-status ${type} show`;
        setTimeout(() => status.classList.remove('show'), 5000);
      }
    }

    function updateColorPreview(hex, labValues = null) {
      const preview = document.getElementById('cmw-color-preview');
      if (preview) preview.style.backgroundColor = hex;
      
      const info = document.getElementById('cmw-selected-color-info');
      const labEl = document.getElementById('cmw-selected-color-lab');
      
      if (labValues && info && labEl) {
        info.classList.add('show');
        labEl.textContent = `L*: ${labValues[0].toFixed(1)}, a*: ${labValues[1].toFixed(1)}, b*: ${labValues[2].toFixed(1)}`;
      } else if (info) {
        info.classList.remove('show');
      }
    }

    function displayResults(results) {
      const table = document.getElementById('cmw-out');
      const tbody = table?.querySelector('tbody');
      
      if (!table || !tbody) return;
      
      tbody.innerHTML = '';
      
      if (!results || results.length === 0) {
        showStatus('No matches found', 'warning');
        table.hidden = true;
        return;
      }
      
      results.forEach(match => {
        const row = tbody.insertRow();
        
        const swatchCell = row.insertCell();
        const swatch = document.createElement('div');
        swatch.className = 'cmw-swatch';
        swatch.style.backgroundColor = match.hex;
        swatchCell.appendChild(swatch);
        
        row.insertCell().textContent = match.name;
        row.insertCell().textContent = match.brand || match.family || 'N/A';
        row.insertCell().textContent = match.delta_e?.toFixed(2) || 'N/A';
        
        const labCell = row.insertCell();
        if (match.lab) {
          labCell.textContent = `L*:${match.lab[0].toFixed(1)} a*:${match.lab[1].toFixed(1)} b*:${match.lab[2].toFixed(1)}`;
        } else {
          labCell.textContent = 'N/A';
        }
      });
      
      table.hidden = false;
      showStatus(`Found ${results.length} matches!`);
    }

    async function handleSearch() {
      const searchType = document.getElementById('cmw-search-type-select')?.value || 'name';
      
      let inputType, value;
      
      if (searchType === 'name') {
        const input = document.getElementById('cmw-name-input');
        if (!input || !input.value.trim()) {
          showStatus('Please enter a color name or hex code', 'warning');
          return;
        }
        
        value = input.value.trim();
        
        if (value.startsWith('#') || /^[0-9A-Fa-f]{6}$/.test(value)) {
          inputType = 'hex';
          value = value.startsWith('#') ? value : `#${value}`;
        } else {
          inputType = 'bastone';
        }
        
      } else if (searchType === 'lab') {
        const l = document.getElementById('cmw-lab-l')?.value;
        const a = document.getElementById('cmw-lab-a')?.value;
        const b = document.getElementById('cmw-lab-b')?.value;
        
        if (!l || !a || !b) {
          showStatus('Please enter all Lab values', 'warning');
          return;
        }
        
        inputType = 'lab';
        value = `${l},${a},${b}`;
        
      } else if (searchType === 'rgb') {
        const r = document.getElementById('cmw-rgb-r')?.value;
        const g = document.getElementById('cmw-rgb-g')?.value;
        const b = document.getElementById('cmw-rgb-b')?.value;
        
        if (!r || !g || !b) {
          showStatus('Please enter all RGB values', 'warning');
          return;
        }
        
        inputType = 'rgb';
        value = `${r},${g},${b}`;
        
      } else if (searchType === 'cmyk') {
        showStatus('CMYK not yet implemented. Use hex or RGB.', 'warning');
        return;
      }
      
      try {
        showLoading(true);
        
        const result = await callColorMatchAPI(inputType, value);
        
        if (result.input?.hex) {
          updateColorPreview(result.input.hex, result.input.lab);
        }
        
        let allMatches = result.matches || [];
        
        if (result.input?.lab) {
          const targetLab = result.input.lab;
          
          const enabledLibraries = [];
          ['pantone', 'behr', 'sherwin', 'bm'].forEach(lib => {
            const checkbox = document.getElementById(`toggle-${lib}`);
            if (checkbox && checkbox.checked && libs[lib]) {
              enabledLibraries.push(lib);
            }
          });
          
          const resultsPerLibrary = parseInt(document.getElementById('cmw-results-count')?.value || '1');
          
          enabledLibraries.forEach(libraryName => {
            const colors = libs[libraryName];
            if (!colors) return;
            
            const libraryMatches = colors.map(color => {
              const deltaE = calculateDeltaE(targetLab, color.lab);
              return {
                ...color,
                library: libNames[libraryName],
                brand: libNames[libraryName],
                delta_e: deltaE
              };
            });
            
            libraryMatches.sort((a, b) => a.delta_e - b.delta_e);
            allMatches = allMatches.concat(libraryMatches.slice(0, resultsPerLibrary));
          });
          
          allMatches.sort((a, b) => a.delta_e - b.delta_e);
        }
        
        showLoading(false);
        
        if (allMatches.length > 0) {
          displayResults(allMatches);
        } else {
          showStatus('No matches found', 'warning');
        }
        
      } catch (error) {
        showLoading(false);
        console.error('Search error:', error);
      }
    }
    
    function calculateDeltaE(lab1, lab2) {
      const dL = lab2[0] - lab1[0];
      const da = lab2[1] - lab1[1];
      const db = lab2[2] - lab1[2];
      return Math.sqrt(dL * dL + da * da + db * db);
    }

    function handleInputTypeChange() {
      const searchType = document.getElementById('cmw-search-type-select')?.value;
      
      document.querySelectorAll('.cmw-value-inputs').forEach(el => {
        el.classList.remove('active');
      });
      
      const inputGroups = {
        'name': 'cmw-name-inputs',
        'lab': 'cmw-lab-inputs',
        'rgb': 'cmw-rgb-inputs',
        'cmyk': 'cmw-cmyk-inputs'
      };
      
      const targetId = inputGroups[searchType];
      if (targetId) {
        document.getElementById(targetId)?.classList.add('active');
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      const searchBtn = document.getElementById('cmw-search-btn');
      if (searchBtn) searchBtn.addEventListener('click', handleSearch);
      
      const searchTypeSelect = document.getElementById('cmw-search-type-select');
      if (searchTypeSelect) searchTypeSelect.addEventListener('change', handleInputTypeChange);
      
      document.querySelectorAll('.cmw-value-inputs input').forEach(input => {
        input.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') handleSearch();
        });
      });
      
      console.log('🎨 BOTM Color Match Widget initialized');
      console.log('API Base URL:', API_BASE_URL);
      
      showLoading(true);
      
      Promise.allSettled(Object.entries(urls).map(([id, u]) => load(id, u)))
        .then(() => {
          showLoading(false);
          libsLoaded = true;
          const totalColors = Object.values(libs).reduce((sum, lib) => sum + (lib?.length || 0), 0);
          if (totalColors > 0) {
            showStatus(`Color libraries loaded successfully! ${totalColors} colors available.`, 'success');
          } else {
            showStatus('Warning: No color libraries loaded. Check console for errors.', 'warning');
          }
          console.log('All library fetches completed');
          console.log('Libraries loaded:', libs);
        })
        .catch(() => {
          showLoading(false);
          showStatus('Failed to load some color libraries. Functionality may be limited.', 'warning');
        });
    });
  </script>

</body>
</html>
